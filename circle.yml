machine:
  node:
    version: 0.10.22
checkout:
  post:
    - git submodule sync
    - git submodule update --init

dependencies:
  pre:
    - gem install sass --no-ri --no-rdoc
  override:
    - npm install
    - npm test
    
    - zip -r app.zip Dockerfile build/
test:
  override:
    - echo "No tests!"
deployment:
  production:
    branch: master
    commands:
      - ssh-keyscan $DEPLOY_SERVER > ~/.ssh/known_hosts
      
      - scp app.zip core@$DEPLOY_SERVER:~/$CIRCLE_PROJECT_REPONAME.zip
      - scp deploy.sh core@$DEPLOY_SERVER:~/deploy.sh
      
      - ssh core@$DEPLOY_SERVER ./deploy.sh $CIRCLE_PROJECT_REPONAME $CIRCLE_SHA1
